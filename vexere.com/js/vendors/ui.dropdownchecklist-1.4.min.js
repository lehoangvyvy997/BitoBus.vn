(function(n){n.widget("ui.dropdownchecklist",{version:function(){alert("DropDownCheckList v1.4")},_appendDropContainer:function(t){var i=n("<div/>"),r;return i.addClass("ui-dropdownchecklist ui-dropdownchecklist-dropcontainer-wrapper"),i.addClass("ui-widget"),i.attr("id",t.attr("id")+"-ddw"),i.css({position:"absolute",left:"-33000px",top:"-33000px"}),r=n("<div/>"),r.addClass("ui-dropdownchecklist-dropcontainer ui-widget-content"),r.css("overflow-y","auto"),i.append(r),i.insertAfter(t),i.isOpen=!1,i},_isDropDownKeyShortcut:function(t,i){return t.altKey&&n.ui.keyCode.DOWN==i},_isDropDownCloseKey:function(t,i){return n.ui.keyCode.ESCAPE==i||n.ui.keyCode.ENTER==i},_keyFocusChange:function(t,i,r){var f=n(":focusable"),u=f.index(t);if(u>=0){if(u+=i,r){var e=this.dropWrapper.find("input:not([disabled])"),o=f.index(e.get(0)),s=f.index(e.get(e.length-1));u<o?u=s:u>s&&(u=o)}f.get(u).focus()}},_handleKeyboard:function(t){var i=this,r=t.keyCode||t.which;!i.dropWrapper.isOpen&&i._isDropDownKeyShortcut(t,r)?(t.stopImmediatePropagation(),i._toggleDropContainer(!0)):i.dropWrapper.isOpen&&i._isDropDownCloseKey(t,r)?(t.stopImmediatePropagation(),i._toggleDropContainer(!1),i.controlSelector.focus()):i.dropWrapper.isOpen&&t.target.type=="checkbox"&&(r==n.ui.keyCode.DOWN||r==n.ui.keyCode.UP)?(t.stopImmediatePropagation(),i._keyFocusChange(t.target,r==n.ui.keyCode.DOWN?1:-1,!0)):i.dropWrapper.isOpen&&r==n.ui.keyCode.TAB},_handleFocus:function(t,i,r){var u=this;r&&!u.dropWrapper.isOpen?(t.stopImmediatePropagation(),i?(u.controlSelector.addClass("ui-state-hover"),n.ui.dropdownchecklist.gLastOpened!=null&&n.ui.dropdownchecklist.gLastOpened._toggleDropContainer(!1)):u.controlSelector.removeClass("ui-state-hover")):r||i||(t!=null&&t.stopImmediatePropagation(),u.controlSelector.removeClass("ui-state-hover"),u._toggleDropContainer(!1))},_cancelBlur:function(){var n=this;n.blurringItem!=null&&(clearTimeout(n.blurringItem),n.blurringItem=null)},_appendControl:function(){var i=this,h=this.sourceSelect,e=this.options,r=n("<span/>"),f,t,u,c,o,s;return r.addClass("ui-dropdownchecklist ui-dropdownchecklist-selector-wrapper ui-widget"),r.css({display:"inline-block",cursor:"default",overflow:"hidden"}),f=h.attr("id"),f=f==null||f==""?"ddcl-"+n.ui.dropdownchecklist.gIDCounter++:"ddcl-"+f,r.attr("id",f),t=n("<span/>"),t.addClass("ui-dropdownchecklist-selector ui-state-default"),t.css({display:"inline-block",overflow:"hidden","white-space":"nowrap"}),u=h.attr("tabIndex"),u==null?u=0:(u=parseInt(u),u<0&&(u=0)),t.attr("tabIndex",u),t.keyup(function(n){i._handleKeyboard(n)}),t.focus(function(n){i._handleFocus(n,!0,!0)}),t.blur(function(n){i._handleFocus(n,!1,!0)}),r.append(t),e.icon!=null&&(c=e.icon.placement==null?"left":e.icon.placement,o=n("<div/>"),o.addClass("ui-icon"),o.addClass(e.icon.toOpen!=null?e.icon.toOpen:"ui-icon-triangle-1-e"),o.css({float:c}),t.append(o)),s=n("<span/>"),s.addClass("ui-dropdownchecklist-text"),s.css({display:"inline-block","white-space":"nowrap",overflow:"hidden"}),t.append(s),r.hover(function(){i.disabled||t.addClass("ui-state-hover")},function(){i.disabled||t.removeClass("ui-state-hover")}),r.click(function(n){i.disabled||(n.stopImmediatePropagation(),i._toggleDropContainer(!i.dropWrapper.isOpen))}),r.insertAfter(h),n(window).resize(function(){!i.disabled&&i.dropWrapper.isOpen&&i._toggleDropContainer(!0)}),r},_createDropItem:function(t,i,r,u,f,e,o,s){var h=this,y=this.options,p=this.sourceSelect,d=this.controlWrapper,c=n("<div/>"),l;c.addClass("ui-dropdownchecklist-item");c.css({"white-space":"nowrap"});var w=e?' checked="checked"':"",b=o?' class="inactive"':' class="active"',k=d.attr("id"),v=k+"-i"+t,a;return a=h.isMultiple?n('<input disabled type="checkbox" id="'+v+'"'+w+b+' tabindex="'+i+'" />'):n('<input disabled type="radio" id="'+v+'" name="'+k+'"'+w+b+' tabindex="'+i+'" />'),a=a.attr("index",t).val(r),c.append(a),l=n("<label for="+v+"/>"),l.addClass("ui-dropdownchecklist-text"),f!=null&&l.attr("style",f),l.css({cursor:"default"}),l.html(u),s&&c.addClass("ui-dropdownchecklist-indent"),c.addClass("ui-state-default"),o&&c.addClass("ui-state-disabled"),l.click(function(n){n.stopImmediatePropagation()}),c.append(l),c.hover(function(){var t=n(this);t.hasClass("ui-state-disabled")||t.addClass("ui-state-hover")},function(){var t=n(this);t.removeClass("ui-state-hover")}),a.click(function(t){var i=n(this),r;if(t.stopImmediatePropagation(),i.hasClass("active")){if(r=h.options.onItemClick,n.isFunction(r))try{r.call(h,i,p.get(0))}catch(u){i.prop("checked",!i.prop("checked"));h._syncSelected(i);return}h._syncSelected(i);h.sourceSelect.trigger("change","ddcl_internal");!h.isMultiple&&y.closeRadioOnClick&&h._toggleDropContainer(!1)}}),c.click(function(t){var u=n(this),i,r,f;if(t.stopImmediatePropagation(),u.hasClass("ui-state-disabled"))u.focus(),h._cancelBlur();else{if(i=u.find("input"),r=i.prop("checked"),i.prop("checked",!r),f=h.options.onItemClick,n.isFunction(f))try{f.call(h,i,p.get(0))}catch(e){i.prop("checked",r);h._syncSelected(i);return}h._syncSelected(i);h.sourceSelect.trigger("change","ddcl_internal");r||h.isMultiple||!y.closeRadioOnClick||h._toggleDropContainer(!1)}}),c.focus(function(t){var i=n(this);t.stopImmediatePropagation()}),c.keyup(function(n){h._handleKeyboard(n)}),c},_createGroupItem:function(t,i){var f=this,r=n("<div />"),u;return r.addClass("ui-dropdownchecklist-group ui-widget-header"),i&&r.addClass("ui-state-disabled"),r.css({"white-space":"nowrap"}),u=n("<span/>"),u.addClass("ui-dropdownchecklist-text"),u.css({cursor:"default"}),u.text(t),r.append(u),r.click(function(t){var i=n(this);t.stopImmediatePropagation();i.focus();f._cancelBlur()}),r.focus(function(t){var i=n(this);t.stopImmediatePropagation()}),r},_createCloseItem:function(t){var u=this,i=n("<div />"),r;return i.addClass("ui-state-default ui-dropdownchecklist-close ui-dropdownchecklist-item"),i.css({"white-space":"nowrap","text-align":"right"}),r=n("<span/>"),r.addClass("ui-dropdownchecklist-text"),r.css({cursor:"default"}),r.html(t),i.append(r),i.click(function(t){var i=n(this);t.stopImmediatePropagation();i.focus();u._toggleDropContainer(!1)}),i.hover(function(){n(this).addClass("ui-state-hover")},function(){n(this).removeClass("ui-state-hover")}),i.focus(function(t){var i=n(this);t.stopImmediatePropagation()}),i},_appendItems:function(){var i=this,r=this.options,o=this.sourceSelect,s=this.dropWrapper,t=s.find(".ui-dropdownchecklist-dropcontainer"),u,f,e;return o.children().each(function(r){var u=n(this),f,e,o;u.is("option")?i._appendOption(u,t,r,!1,!1):u.is("optgroup")&&(f=u.prop("disabled"),e=u.attr("label"),e!=""&&(o=i._createGroupItem(e,f),t.append(o)),i._appendOptions(u,t,r,!0,f))}),r.explicitClose!=null&&(u=i._createCloseItem(r.explicitClose),t.append(u)),f=t.outerWidth(),e=t.outerHeight(),{width:f,height:e}},_appendOptions:function(t,i,r,u,f){var e=this;t.children("option").each(function(t){var o=n(this),s=r+"."+t;e._appendOption(o,i,s,u,f)})},_appendOption:function(n,t,i,r,u){var e=this,f=n.html();if(f!=null&&f!=""){var o=n.val(),s=n.attr("style"),h=n.prop("selected"),c=u||n.prop("disabled"),l=e.controlSelector.attr("tabindex"),a=e._createDropItem(i,l,o,f,s,h,c,r);t.append(a)}},_syncSelected:function(t){var c=this,o=this.options,l=this.sourceSelect,s=this.dropWrapper,f=l.get(0).options,i=s.find("input.active"),h,u,r,e;o.firstItemChecksAll=="exclusive"?t==null&&n(f[0]).prop("selected")?(i.prop("checked",!1),n(i[0]).prop("checked",!0)):t!=null&&t.attr("index")==0?(h=t.prop("checked"),i.prop("checked",!1),n(i[0]).prop("checked",h)):(u=!0,r=null,i.each(function(t){if(t>0){var i=n(this).prop("checked");i||(u=!1)}else r=n(this)}),r!=null&&(u&&i.prop("checked",!1),r.prop("checked",u))):o.firstItemChecksAll&&(t==null&&n(f[0]).prop("selected")?i.prop("checked",!0):t!=null&&t.attr("index")==0?i.prop("checked",t.prop("checked")):(u=!0,r=null,i.each(function(t){if(t>0){var i=n(this).prop("checked");i||(u=!1)}else r=n(this)}),r!=null&&r.prop("checked",u)));e=0;i=s.find("input");i.each(function(t){var i=n(f[t+e]),r=i.html();(r==null||r=="")&&(e+=1,i=n(f[t+e]));i.prop("selected",n(this).prop("checked"))});c._updateControlText();t!=null&&t.focus()},_sourceSelectChangeHandler:function(){var n=this,t=this.dropWrapper;t.find("input").val(n.sourceSelect.val());n._updateControlText()},_updateControlText:function(){var i=this,t=this.sourceSelect,r=this.options,u=this.controlWrapper,f=t.find("option:first"),e=t.find("option"),o=i._formatText(e,r.firstItemChecksAll,f),n=u.find(".ui-dropdownchecklist-text");n.html(o);n.attr("title",n.text())},_formatText:function(t,i,r){var u;if(n.isFunction(this.options.textFormatFunction))try{u=this.options.textFormatFunction(t)}catch(f){alert("textFormatFunction failed: "+f)}else i&&r!=null&&r.prop("selected")?u=r.html():(u="",t.each(function(){if(n(this).prop("selected")){u!=""&&(u+=", ");var i=n(this).attr("style"),t=n("<span/>");t.html(n(this).html());i==null?u+=t.html():(t.attr("style",i),u+=n("<span/>").append(t).html())}}),u==""&&(u=this.options.emptyText!=null?this.options.emptyText:"&nbsp;"));return u},_toggleDropContainer:function(t){var r=this,i=function(t){var r,f,u;if(t!=null&&t.dropWrapper.isOpen&&(t.dropWrapper.isOpen=!1,n.ui.dropdownchecklist.gLastOpened=null,r=t.options,t.dropWrapper.css({top:"-33000px",left:"-33000px"}),f=t.controlSelector,f.removeClass("ui-state-active"),f.removeClass("ui-state-hover"),u=t.controlWrapper.find(".ui-icon"),u.length>0&&(u.removeClass(r.icon.toClose!=null?r.icon.toClose:"ui-icon-triangle-1-s"),u.addClass(r.icon.toOpen!=null?r.icon.toOpen:"ui-icon-triangle-1-e")),n(document).unbind("click",i),t.dropWrapper.find("input.active").prop("disabled",!0),n.isFunction(r.onComplete)))try{r.onComplete.call(t,t.sourceSelect.get(0))}catch(e){alert("callback failed: "+e)}},u=function(t){var r,u,c,e,o,f,s,h;t.dropWrapper.isOpen||(t.dropWrapper.isOpen=!0,n.ui.dropdownchecklist.gLastOpened=t,r=t.options,r.positionHow==null||r.positionHow=="absolute"?t.dropWrapper.css({position:"absolute",top:t.controlWrapper.position().top+t.controlWrapper.outerHeight()+"px",left:t.controlWrapper.position().left+"px"}):r.positionHow=="relative"&&t.dropWrapper.css({position:"relative",top:"0px",left:"0px"}),u=0,r.zIndex==null?(c=t.controlWrapper.parents().map(function(){var t=n(this).css("z-index");return isNaN(t)?0:t}).get(),e=Math.max.apply(Math,c),e>=0&&(u=e+1)):u=parseInt(r.zIndex),u>0&&t.dropWrapper.css({"z-index":u}),o=t.controlSelector,o.addClass("ui-state-active"),o.removeClass("ui-state-hover"),f=t.controlWrapper.find(".ui-icon"),f.length>0&&(f.removeClass(r.icon.toOpen!=null?r.icon.toOpen:"ui-icon-triangle-1-e"),f.addClass(r.icon.toClose!=null?r.icon.toClose:"ui-icon-triangle-1-s")),n(document).bind("click",function(){i(t)}),s=t.dropWrapper.find("input.active"),s.prop("disabled",!1),h=s.get(0),h!=null&&h.focus())};t?(i(n.ui.dropdownchecklist.gLastOpened),u(r)):i(r)},_setSize:function(t){var r=this.options,s=this.dropWrapper,l=this.controlWrapper,i=t.width,f,u,h,e;r.width!=null?i=parseInt(r.width):r.minWidth!=null&&(f=parseInt(r.minWidth),i<f&&(i=f));u=this.controlSelector;u.css({width:i+"px"});h=u.find(".ui-dropdownchecklist-text");e=u.find(".ui-icon");e!=null&&(i-=e.outerWidth()+4,h.css({width:i+"px"}));i=l.outerWidth();var o=r.maxDropHeight!=null?parseInt(r.maxDropHeight):-1,c=o>0&&t.height>o?o:t.height,a=t.width<i?i:t.width;n(s).css({height:c+"px",width:a+"px"});s.find(".ui-dropdownchecklist-dropcontainer").css({height:c+"px"})},_init:function(){var t=this,u=this.options,i,r,f,e;n.ui.dropdownchecklist.gIDCounter==null&&(n.ui.dropdownchecklist.gIDCounter=1);t.blurringItem=null;i=t.element;t.initialDisplay=i.css("display");i.css("display","none");t.initialMultiple=i.prop("multiple");t.isMultiple=t.initialMultiple;u.forceMultiple!=null&&(t.isMultiple=u.forceMultiple);i.prop("multiple",!0);t.sourceSelect=i;r=t._appendControl();t.controlWrapper=r;t.controlSelector=r.find(".ui-dropdownchecklist-selector");f=t._appendDropContainer(r);t.dropWrapper=f;e=t._appendItems();t._updateControlText(r,f,i);t._setSize(e);u.firstItemChecksAll&&t._syncSelected(null);u.bgiframe&&typeof t.dropWrapper.bgiframe=="function"&&t.dropWrapper.bgiframe();t.sourceSelect.change(function(n,i){i!="ddcl_internal"&&t._sourceSelectChangeHandler(n)})},_refreshOption:function(n,t,i){var r=n.parent();t?(n.prop("disabled",!0),n.removeClass("active"),n.addClass("inactive"),r.addClass("ui-state-disabled")):(n.prop("disabled",!1),n.removeClass("inactive"),n.addClass("active"),r.removeClass("ui-state-disabled"));n.prop("checked",i)},_refreshGroup:function(n,t){t?n.addClass("ui-state-disabled"):n.removeClass("ui-state-disabled")},close:function(){this._toggleDropContainer(!1)},refresh:function(){var t=this,e=this.sourceSelect,r=this.dropWrapper,u=r.find("input"),o=r.find(".ui-dropdownchecklist-group"),f=0,i=0;e.children().each(function(){var r=n(this),e=r.prop("disabled"),s,h,c,l;r.is("option")?(s=r.prop("selected"),h=n(u[i]),t._refreshOption(h,e,s),i+=1):r.is("optgroup")&&(c=r.attr("label"),c!=""&&(l=n(o[f]),t._refreshGroup(l,e),f+=1),r.children("option").each(function(){var r=n(this),f=e||r.prop("disabled"),o=r.prop("selected"),s=n(u[i]);t._refreshOption(s,f,o);i+=1}))});t._syncSelected(null)},enable:function(){this.controlSelector.removeClass("ui-state-disabled");this.disabled=!1},disable:function(){this.controlSelector.addClass("ui-state-disabled");this.disabled=!0},destroy:function(){n.Widget.prototype.destroy.apply(this,arguments);this.sourceSelect.css("display",this.initialDisplay);this.sourceSelect.prop("multiple",this.initialMultiple);this.controlWrapper.unbind().remove();this.dropWrapper.remove()}});n.extend(n.ui.dropdownchecklist,{defaults:{width:null,maxDropHeight:null,firstItemChecksAll:!1,closeRadioOnClick:!1,minWidth:50,positionHow:"absolute",bgiframe:!1,explicitClose:null}})})(jQuery);
//# sourceMappingURL=ui.dropdownchecklist-1.4.min.js.map
