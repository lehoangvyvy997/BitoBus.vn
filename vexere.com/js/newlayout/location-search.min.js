(function(n,t){var w,i,p;try{function o(n){var r,t;if(n.length==0)return null;var i={},u=n[0],f=1;for(r=0;r<n.length;r++)t=n[r],i[t]==null?i[t]=1:i[t]++,i[t]>f&&(u=t,f=i[t]);return u}function u(n){try{var t=JSON.parse(n||"[]");return Object.prototype.toString.call(t)!=="[object Array]"?[]:t}catch(i){return[]}}function b(){return t?t:null}function k(){if(!t)return!1;for(var i=0,f,n=["fromType","#start-point-type","fromId","#start-point-id","fromName","#departPlace","toType","#stop-point-type","toId","#stop-point-id","toName","#destination"],o=n.length,r,e;i<n.length;i+=2)f=i+1,r=u(t[n[i]]),e=$(n[f]).val().indexOf(",")>=0?$(n[f]).val():$(n[f]).val().replace(/,/ig),e&&(r.unshift(e),r.length>20&&(r.length=20),t[n[i]]=JSON.stringify(r))}$("#searchForm").on("submit",k);var v=$("#banggia .table-banggia"),s=[],y=[],h=[],c=[],l=!1;if(v&&v.length>0&&(l=!0,w=v.find("tbody tr"),$.each(w,function(n,t){s.push(+$(t).attr("data-fromid"));y.push($(t).attr("data-fromname"));h.push(+$(t).attr("data-toid"));c.push($(t).attr("data-toname"))})),i=b(),i&&i.fromId){var r=[],f=[],e=[],a=0;if(l?$.each(u(i.fromId),function(n,t){s.indexOf(t)>=0&&(r.push(+t),f.push(y[s.indexOf(t)]),e.push(1))}):(r=u(i.fromId),f=u(i.fromName),e=u(i.fromType)),r.length>0)return a=o(r),$("#start-point-type").val(o(e)),$("#start-point-id").val(a),$("#departPlace").val(o(f)),i.toId&&(r=[],f=[],e=[],l?($.each(u(i.toId),function(n,t){h.indexOf(t)>=0&&t!=a&&(r.push(+t),f.push(c[h.indexOf(t)]),e.push(1))}),r.length==0&&(p=s.indexOf(a),r.push(h[p]),f.push(c[p]),e.push(1))):(r=u(i.toId),f=u(i.toName),e=u(i.toType)),$("#stop-point-type").val(o(e)),$("#stop-point-id").val(o(r)),$("#destination").val(o(f))),!0}if(!n.geolocation)return!1;n.geolocation.getCurrentPosition(function(n){var i=new google.maps.Geocoder,r=new google.maps.LatLng(n.coords.latitude,n.coords.longitude),t=document.head.lang;i.geocode({latLng:r},function(n,i){var e,o,a,r,u,v,f;if(i==google.maps.GeocoderStatus.OK){for(u in n[0].address_components)if(e=n[0].address_components[u],e.types[0]==="administrative_area_level_1")for(o=e.long_name,a=locdau(o),u=0,v=statecity.length;u<v;u++)if(r=statecity[u],~locdau(r.label).indexOf(a)){l?(f=s.indexOf(+r.StateId),f>=0?(t=="en"?$("#departPlace").val(changeEnglish(r.value)):$("#departPlace").val(r.value),r.CityId>0?($("#start-point-type").val(2),$("#start-point-id").val(r.CityId)):($("#start-point-type").val(1),$("#start-point-id").val(r.StateId)),$("#stop-point-type").val(1),$("#stop-point-id").val(h[f]),$("#destination").val(c[f])):($("#start-point-type").val(1),$("#start-point-id").val(s[0]||null),$("#departPlace").val(y[0]||null),$("#stop-point-type").val(1),$("#stop-point-id").val(h[0]||null),$("#destination").val(c[0]||null))):(t=="en"?$("#departPlace").val(changeEnglish(r.value)):$("#departPlace").val(r.value),r.CityId>0?($("#start-point-type").val(2),$("#start-point-id").val(r.CityId)):($("#start-point-type").val(1),$("#start-point-id").val(r.StateId)));break}}else console&&console.log("Geocoder failed due to: "+i)})})}catch(d){console&&console.log(d)}})(navigator,localStorage);